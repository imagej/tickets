<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  

  
  <!-- See: http://trac.edgewall.org/wiki/TracInterfaceCustomization -->


  <head>
    <title>
      #667 (Stack To Images problematic with RGB input)
     â€“ ImageJ
    </title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <link rel="stylesheet" href="trac.css" type="text/css" /><link rel="stylesheet" href="ticket.css" type="text/css" /><link rel="stylesheet" href="tracvote.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="style.css" />
  </head>
  <body>
    <div id="main">
    <div id="content" class="ticket">
      <h1 id="trac-ticket-title">
          <a href="667.html">Ticket #667</a>
          <span class="status">(closed defect: fixed)</span>
      </h1>
      <div id="ticket">
  <div class="date">
    <p>Opened 2011-07-08T16:44:36-05:00</p>
    <p>Last modified 2011-08-11T13:32:08-05:00</p>
  </div>
  <h2 class="summary searchable">Stack To Images problematic with RGB input</h2>
  <table class="properties">
    <tr>
      <th id="h_reporter">Reported by:</th>
      <td headers="h_reporter" class="searchable">
        bdezonia
      </td>
      <th id="h_owner">Owned by:</th>
      <td headers="h_owner">
        bdezonia
      </td>
    </tr>
    <tr>
        <th id="h_priority">
          Priority:
        </th>
        <td headers="h_priority">
              major
        </td>
        <th id="h_milestone">
          Milestone:
        </th>
        <td headers="h_milestone">
              <strike>imagej-2.0-alpha5</strike>
        </td>
    </tr><tr>
        <th id="h_component">
          Component:
        </th>
        <td headers="h_component">
              Legacy Compatibility
        </td>
        <th id="h_version">
          Version:
        </th>
        <td headers="h_version">
              
        </td>
    </tr><tr>
        <th id="h_severity">
          Severity:
        </th>
        <td headers="h_severity">
              serious
        </td>
        <th id="h_keywords">
          Keywords:
        </th>
        <td headers="h_keywords" class="searchable">
        </td>
    </tr><tr>
        <th id="h_cc">
          Cc:
        </th>
        <td headers="h_cc" class="searchable">
        </td>
        <th id="h_blockedby">
          Blocked By:
        </th>
        <td headers="h_blockedby">
        </td>
    </tr><tr>
        <th id="h_blocking">
          Blocking:
        </th>
        <td headers="h_blocking">
        </td>
        <th>
        </th>
        <td>
        </td>
    </tr>
  </table>
  <div class="description">
    <h3 id="comment:description">
      Description
    </h3>
    <div class="searchable">
      <p>
The stack to images command does not react well with RGB data. Open Leaf and Edit Colors to grayscale. Now try Stack To Images. Usually it will complain that a stack is required. Sometimes it will reset the view luts so that the image colors change. And sometimes it throws an exception:<br />
</p>
<p>
java.lang.IndexOutOfBoundsException: Index: 1, Size: 1<br />
</p>
<blockquote>
<p>
at java.util.ArrayList.RangeCheck(ArrayList.java:547)<br />
at java.util.ArrayList.get(ArrayList.java:322)<br />
at imagej.display.AbstractDatasetView.updateLUTs(AbstractDatasetView.java:298)<br />
at imagej.display.AbstractDatasetView.setColorTable(AbstractDatasetView.java:135)<br />
at imagej.legacy.LegacyUtils.assignColorTables(LegacyUtils.java:1187)<br />
at imagej.legacy.LegacyUtils.setDisplayLuts(LegacyUtils.java:748)<br />
at imagej.legacy.DatasetHarmonizer.updateDisplay(DatasetHarmonizer.java:165)<br />
at imagej.legacy.plugin.LegacyPlugin.postPluginHarmonization(LegacyPlugin.java:164)<br />
at imagej.legacy.plugin.LegacyPlugin.run(LegacyPlugin.java:109)<br />
at imagej.plugin.PluginRunner.run(PluginRunner.java:84)<br />
at imagej.plugin.PluginManager$1.run(PluginManager.java:151)<br />
at java.lang.Thread.run(Thread.java:680)<br />
</p>
</blockquote>

    </div>
  </div>
</div>
          

        <div>
          <h2 class="foldable">Change History</h2>
          <div id="changelog">
              <div class="change" id="trac-change-1">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:1" class="cnum">
      <a href="#comment:1">comment:1</a>
    </span>
                  </span>
                  Changed 2011-07-11T14:16:57-05:00 by bdezonia
                </h3>
                
    <div class="comment searchable">
      
      <p>
After fixing an issue with RGB data in DatasetHarmonizer (272a63e1739a422394bcbe72707d58e966e17409) I can no longer duplicate the exception.<br />
</p>
<p>
But the lut changing is still happening. Basically the plugin sees the input data is invalid and does nothing. But the Harmonizer assumes things have changes and manipulates the ColorTables. The LUT/ColorTable code is inconsistent.<br />
</p>

    </div>

              </div>
              <div class="change" id="trac-change-2">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:2" class="cnum">
      <a href="#comment:2">comment:2</a>
    </span>
                  </span>
                  Changed 2011-07-29T14:01:29-05:00 by bdezonia
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Milestone</strong>
        changed from <em>biweekly-2011: Jul-18 to Jul-29</em> to <em>imagej-2.0-alpha5</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
This is another legacy color/lut issue. See also <a class="closed ticket" href="665.html" title="defect: A Display can go from Composite to Color unexpectedly (closed: fixed)">#665</a> and <a class="closed ticket" href="701.html" title="defect: LUTs getting out of sync (closed: fixed)">#701</a><br />
</p>

    </div>

              </div>
              <div class="change" id="trac-change-3">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:3" class="cnum">
      <a href="#comment:3">comment:3</a>
    </span>
                  </span>
                  Changed 2011-08-11T13:32:08-05:00 by bdezonia
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>new</em> to <em>closed</em>
    </li><li>
      <strong>Resolution</strong>
        set to <em>fixed</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
Fixed in 97ba2789250130ab526723082e0e3b2bc82b968f.<br />
</p>

    </div>

              </div>
          </div>
        </div>
    </div>
    </div>
  </body>
</html>
