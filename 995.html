<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  

  
  <!-- See: http://trac.edgewall.org/wiki/TracInterfaceCustomization -->


  <head>
    <title>
      #995 (Headless displays)
     – ImageJ
    </title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <link rel="stylesheet" href="trac.css" type="text/css" /><link rel="stylesheet" href="ticket.css" type="text/css" /><link rel="stylesheet" href="tracvote.css" type="text/css" />
    <script type="text/javascript">
      var auto_preview_timeout=2.0;
      var form_token="b2595cf820683d4b008dbe56";
    </script>
    <script type="text/javascript" src="/chrome/common/js/jquery.js"></script><script type="text/javascript" src="/chrome/common/js/babel.js"></script><script type="text/javascript" src="/chrome/common/js/trac.js"></script><script type="text/javascript" src="/chrome/common/js/search.js"></script><script type="text/javascript" src="/chrome/common/js/folding.js"></script><script type="text/javascript" src="/chrome/common/js/wikitoolbar.js"></script><script type="text/javascript" src="/chrome/common/js/resizer.js"></script><script type="text/javascript" src="/chrome/common/js/auto_preview.js"></script>
    <!--[if lt IE 7]>
    <script type="text/javascript" src="/chrome/common/js/ie_pre7_hacks.js"></script>
    <![endif]-->
    <script type="text/javascript">
      jQuery(document).ready(function($) {
        $("div.description").find("h1,h2,h3,h4,h5,h6").addAnchor(_("Link to this section"));
        $(".foldable").enableFolding(false, true);
        var args = {realm: "ticket", id: 995, escape_newlines: 1}
        $("#comment").autoPreview("/wiki_render", args, function(textarea, text, rendered) {
            $("#ticketchange div.comment").html(rendered);
            if (rendered)
              $("#ticketchange").show();
            else if ($("#ticketchange ul.changes").length == 0)
              $("#ticketchange").hide();
        });
        $("#trac-comment-editor textarea").autoPreview("/wiki_render", args,
                                                       function(textarea, text, rendered) {
          var comment = $("#trac-comment-editor").next("div.comment");
          comment.html(rendered);
          if (rendered)
            comment.show();
          else
            comment.hide();
        });
        $("#modify").parent().toggleClass("collapsed");
        $(".trac-topnav a").click(function() { $("#modify").parent().removeClass("collapsed"); });
        /* only enable control elements for the currently selected action */
        var actions = $("#action input[name='action']");
        function updateActionFields() {
          actions.each(function () {
            $(this).siblings().find("*[id]").enable($(this).checked());
            $(this).siblings().filter("*[id]").enable($(this).checked());
          });
        }
        actions.click(updateActionFields);
        updateActionFields();
      });
    </script>
    <link rel="stylesheet" type="text/css" href="style.css" />
  </head>
  <body>
    <div id="main">
    <div id="content" class="ticket">
      <h1 id="trac-ticket-title">
          <a href="/ticket/995">Ticket #995</a>
          <span class="status">(closed feature: fixed)</span>
      </h1>
      <div id="ticket">
  <div class="date">
    <p>Opened 2012-02-22T14:07:58-06:00</p>
    <p>Last modified 2012-05-17T13:46:30-05:00</p>
  </div>
  <h2 class="summary searchable">Headless displays</h2>
  <table class="properties">
    <tr>
      <th id="h_reporter">Reported by:</th>
      <td headers="h_reporter" class="searchable">
        <a href="/query?status=!closed&amp;reporter=curtis">curtis</a>
      </td>
      <th id="h_owner">Owned by:</th>
      <td headers="h_owner">
        <a href="/query?status=!closed&amp;owner=curtis">curtis</a>
      </td>
    </tr>
    <tr>
        <th id="h_priority">
          Priority:
        </th>
        <td headers="h_priority">
              <a href="/query?status=!closed&amp;priority=critical">critical</a>
        </td>
        <th id="h_milestone">
          Milestone:
        </th>
        <td headers="h_milestone">
              <a class="closed milestone" href="/milestone/imagej2-b2-bugfixes">imagej2-b2-bugfixes</a>
        </td>
    </tr><tr>
        <th id="h_component">
          Component:
        </th>
        <td headers="h_component">
              <a href="/query?status=!closed&amp;component=Display+API">Display API</a>
        </td>
        <th id="h_version">
          Version:
        </th>
        <td headers="h_version">
              <a href="/query?status=!closed&amp;version"></a>
        </td>
    </tr><tr>
        <th id="h_severity">
          Severity:
        </th>
        <td headers="h_severity">
              <a href="/query?status=!closed&amp;severity=major">major</a>
        </td>
        <th id="h_keywords">
          Keywords:
        </th>
        <td headers="h_keywords" class="searchable">
        </td>
    </tr><tr>
        <th id="h_cc">
          Cc:
        </th>
        <td headers="h_cc" class="searchable">
        </td>
        <th id="h_blockedby">
          Blocked By:
        </th>
        <td headers="h_blockedby">
              <a class="closed" href="/ticket/616" title="Handle the deletion of Displays">#616</a>
        </td>
    </tr><tr>
        <th id="h_blocking">
          Blocking:
        </th>
        <td headers="h_blocking">
              <a class="assigned" href="/ticket/10" title="Maintain strict separation of concerns (i.e., UI independence)">#10</a>, <a class="closed" href="/ticket/660" title="Improve Display-DisplayView-DataObject hierarchy">#660</a>, <a class="closed" href="/ticket/884" title="Decouple data events from display classes">#884</a>, <a class="accepted" href="/ticket/936" title="Window menu does not pull image to front">#936</a>
        </td>
        <th>
        </th>
        <td>
        </td>
    </tr>
  </table>
  <div class="description">
    <h3 id="comment:description">
      Description
    </h3>
    <div class="searchable">
      <p>
Displays need to become fully UI-agnostic. It should be possible to say e.g. "<tt>new DefaultImageDisplay()</tt>" to create a display (and similarly for <tt>DatasetViews</tt> and <tt>OverlayViews</tt>). The display itself should not be tied to any UI components. Rather, the <tt>UIService</tt> listens for <tt>DisplayEvents</tt> generated by Displays and creates/updates/removes linked UI components such as <tt>DisplayPanels</tt> and <tt>DisplayWindows</tt>. In this fashion, plugins can work with <tt>Displays</tt> without any dependence on specific UI(s).<br />
</p>
<p>
Some specific needed changes:<br />
</p>
<ul><li>Eliminate Display.getPanel method
</li><li>Eliminate ImageDisplay.makeLabel method
</li><li>DisplayPanels/DisplayWindows must be managed by UIService and similar
</li></ul><p>
Some related design details discussed here:<br />
</p>
<blockquote>
<p>
<a class="ext-link" href="http://developer.imagej.net/2011/09/29/display-framework-changes"><span class="icon"> </span>http://developer.imagej.net/2011/09/29/display-framework-changes</a><br />
</p>
</blockquote>

    </div>
  </div>
</div>
          

        <div>
          <h2 class="foldable">Change History</h2>
          <div id="changelog">
              <div class="change" id="trac-change-1">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:1" class="cnum">
      <a href="#comment:1">comment:1</a>
    </span>
                  </span>
                  Changed 2012-02-26T21:37:08-06:00 by curtis
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Blocked By</strong>
        <em>616</em> added
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-1">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:1" class="cnum">
      <a href="#comment:1">comment:1</a>
    </span>
                  </span>
                  Changed 2012-02-26T21:37:13-06:00 by curtis
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Type</strong>
        changed from <em>defect</em> to <em>feature</em>
    </li><li>
      <strong>Blocked By</strong>
        <em>616</em> removed
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-2">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:2" class="cnum">
      <a href="#comment:2">comment:2</a>
    </span>
                  </span>
                  Changed 2012-02-26T21:37:26-06:00 by curtis
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Blocked By</strong>
        <em>616</em> added
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-3">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:3" class="cnum">
      <a href="#comment:3">comment:3</a>
    </span>
                  </span>
                  Changed 2012-02-26T21:42:06-06:00 by curtis
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Blocking</strong>
        <em>10</em> added
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-4">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:4" class="cnum">
      <a href="#comment:4">comment:4</a>
    </span>
                  </span>
                  Changed 2012-03-27T11:56:45-05:00 by curtis
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Blocking</strong>
        <em>936</em> added
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
(In <a class="accepted ticket" href="/ticket/936" title="defect: Window menu does not pull image to front (accepted)">#936</a>) I don't think so. The SelectWindow plugin calls display.activate(), which does fire, but the corresponding window is never selected. Rather, I think finishing the display refactoring (<a class="closed ticket" href="/ticket/995" title="feature: Headless displays (closed: fixed)">#995</a>) will address this issue.<br />
</p>

    </div>

              </div>
              <div class="change" id="trac-change-5">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:5" class="cnum">
      <a href="#comment:5">comment:5</a>
    </span>
                  </span>
                  Changed 2012-03-27T11:57:36-05:00 by curtis
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Blocking</strong>
        <em>884</em> added
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
(In <a class="closed ticket" href="/ticket/884" title="defect: Decouple data events from display classes (closed: moved)">#884</a>) Finishing ticket <a class="closed ticket" href="/ticket/995" title="feature: Headless displays (closed: fixed)">#995</a> will help address this issue.<br />
</p>

    </div>

              </div>
              <div class="change" id="trac-change-4">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:4" class="cnum">
      <a href="#comment:4">comment:4</a>
    </span>
                  </span>
                  Changed 2012-03-28T14:14:21-05:00 by leek
                </h3>
                
    <div class="comment searchable">
      
      <p>
I would like to have a generic UI service that could find the appropriate viewer for a view. The UI service would listen for display created events and use a sez-pos mechanism to find viewers capable of viewing displays.<br />
</p>
<p>
The partition removes the ImageCanvas from ij-data. The DefaultImageDisplay becomes a bag that holds DataViews. The DisplayService creates displays without the help of sez-pos - DisplayService.createDisplay creates a DefaultImageDisplay. DefaultImageDisplay.display() creates DefaultImageViews or DefaultOverlayViews.<br />
</p>
<p>
A viewer would use something like the current three-part discovery and instantiation process:<br />
DisplayViewer.canDisplay(Display) is used to find the first viewer that can handle the display.<br />
DisplayViewer() creates an instance<br />
DisplayViewer.setDisplay(Display) associates viewer and display.<br />
</p>
<p>
There's only so many words for things like "Display" and "Window" and, if possible, you don't want to shake the tree by renaming everything. So "Viewer" is maybe not the best word for the UI component, but it is distinct from Display, Window and View and it means "something that looks at a view" which is not that far from the truth.<br />
</p>
<p>
After this, DisplayViewer listens for events on the display and its views in order to repaint and relayout.<br />
</p>

    </div>

              </div>
              <div class="change" id="trac-change-5">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:5" class="cnum">
      <a href="#comment:5">comment:5</a>
    </span>
                  </span>
                  Changed 2012-04-26T09:14:08-05:00 by curtis
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>new</em> to <em>closed</em>
    </li><li>
      <strong>Resolution</strong>
        set to <em>fixed</em>
    </li><li>
      <strong>Milestone</strong>
        changed from <em>imagej-2.0.0-beta3</em> to <em>imagej-2.0.0-beta2</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
Lee developed this work on a branch which has now been merged as 96adb4f7790e4b7ee2a90581715887cd90343a6a through c0985c4668cfa2751829951f5aaa2d237ca34464.<br />
</p>
<p>
The API is still not completely finalized, and will be further polished moving forward, but it currently addresses the major issues described here, so this ticket is closed!<br />
</p>

    </div>

              </div>
              <div class="change" id="trac-change-6">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:6" class="cnum">
      <a href="#comment:6">comment:6</a>
    </span>
                  </span>
                  Changed 2012-05-17T13:46:30-05:00 by curtis
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Summary</strong>
        changed from <em>Separate core Display class hierarchy from UI implementations</em> to <em>Headless displays</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
          </div>
        </div>
      <div id="help"><strong>Note:</strong> See
        <a href="/wiki/TracTickets">TracTickets</a> for help on using
        tickets.</div>
    </div>
    <div id="altlinks">
      <h3>Download in other formats:</h3>
      <ul>
        <li class="first">
          <a rel="nofollow" href="/ticket/995?format=csv" class="csv">Comma-delimited Text</a>
        </li><li>
          <a rel="nofollow" href="/ticket/995?format=tab" class="tab">Tab-delimited Text</a>
        </li><li class="last">
          <a rel="nofollow" href="/ticket/995?format=rss" class="rss">RSS Feed</a>
        </li>
      </ul>
    </div>
    </div>
    <div id="footer" lang="en" xml:lang="en"><hr />
      <a id="tracpowered" href="http://trac.edgewall.org/"><img src="/chrome/common/trac_logo_mini.png" height="30" width="107" alt="Trac Powered" /></a>
      <p class="left">Powered by <a href="/about"><strong>Trac 0.12.2</strong></a><br />
        By <a href="http://www.edgewall.org/">Edgewall Software</a>.</p>
      <p class="right">Visit the ImageJ project at<br /><a href="http://developer.imagej.net/">http://developer.imagej.net/</a></p>
    </div>
  </body>
</html>
