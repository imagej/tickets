<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  

  
  <!-- See: http://trac.edgewall.org/wiki/TracInterfaceCustomization -->


  <head>
    <title>
      #518 (NullPtrExcep thrown when changing type of image)
     â€“ ImageJ
    </title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <link rel="stylesheet" href="trac.css" type="text/css" /><link rel="stylesheet" href="ticket.css" type="text/css" /><link rel="stylesheet" href="tracvote.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="style.css" />
  </head>
  <body>
    <div id="main">
    <div id="content" class="ticket">
      <h1 id="trac-ticket-title">
          <a href="/ticket/518">Ticket #518</a>
          <span class="status">(closed defect: fixed)</span>
      </h1>
      <div id="ticket">
  <div class="date">
    <p>Opened 2011-05-17T12:26:26-05:00</p>
    <p>Last modified 2011-05-19T17:28:13-05:00</p>
  </div>
  <h2 class="summary searchable">NullPtrExcep thrown when changing type of image</h2>
  <table class="properties">
    <tr>
      <th id="h_reporter">Reported by:</th>
      <td headers="h_reporter" class="searchable">
        bdezonia
      </td>
      <th id="h_owner">Owned by:</th>
      <td headers="h_owner">
        bdezonia
      </td>
    </tr>
    <tr>
        <th id="h_priority">
          Priority:
        </th>
        <td headers="h_priority">
              major
        </td>
        <th id="h_milestone">
          Milestone:
        </th>
        <td headers="h_milestone">
              <a class="closed milestone" href="/milestone/biweekly-2011%3A%20May-09%20to%20May-20">biweekly-2011: May-09 to May-20</a>
        </td>
    </tr><tr>
        <th id="h_component">
          Component:
        </th>
        <td headers="h_component">
              Display API
        </td>
        <th id="h_version">
          Version:
        </th>
        <td headers="h_version">
              
        </td>
    </tr><tr>
        <th id="h_severity">
          Severity:
        </th>
        <td headers="h_severity">
              serious
        </td>
        <th id="h_keywords">
          Keywords:
        </th>
        <td headers="h_keywords" class="searchable">
        </td>
    </tr><tr>
        <th id="h_cc">
          Cc:
        </th>
        <td headers="h_cc" class="searchable">
        </td>
        <th id="h_blockedby">
          Blocked By:
        </th>
        <td headers="h_blockedby">
        </td>
    </tr><tr>
        <th id="h_blocking">
          Blocking:
        </th>
        <td headers="h_blocking">
        </td>
        <th>
        </th>
        <td>
        </td>
    </tr>
  </table>
  <div class="description">
    <h3 id="comment:description">
      Description
    </h3>
    <div class="searchable">
      <p>
If you change the type of an image via Image :: Type submenu the image does not draw (the window shrinking as if no buffered image exists) and you get an exception deep in Event handler and paint code and JHotdraw:<br />
</p>
<p>
Exception in thread "AWT-EventQueue-0" java.lang.NullPointerException<br />
</p>
<blockquote>
<p>
at sun.java2d.SunGraphics2D.getClipBounds(SunGraphics2D.java:1930)<br />
at org.jhotdraw.draw.DefaultDrawing.draw(DefaultDrawing.java:53)<br />
at org.jhotdraw.draw.DefaultDrawingView.drawDrawing(DefaultDrawingView.java:673)<br />
at org.jhotdraw.draw.DefaultDrawingView.drawDrawingVolatileBuffered(DefaultDrawingView.java:463)<br />
at org.jhotdraw.draw.DefaultDrawingView.paintComponent(DefaultDrawingView.java:367)<br />
at javax.swing.JComponent.paint(JComponent.java:1029)<br />
at org.jhotdraw.draw.DefaultDrawingView.paint(DefaultDrawingView.java:739)<br />
at javax.swing.JComponent.paintChildren(JComponent.java:862)<br />
at javax.swing.JComponent.paint(JComponent.java:1038)<br />
at javax.swing.JViewport.paint(JViewport.java:747)<br />
at javax.swing.JComponent.paintChildren(JComponent.java:862)<br />
at javax.swing.JComponent.paint(JComponent.java:1038)<br />
at javax.swing.JComponent.paintChildren(JComponent.java:862)<br />
at javax.swing.JComponent.paint(JComponent.java:1038)<br />
at javax.swing.JComponent.paintChildren(JComponent.java:862)<br />
at javax.swing.JComponent.paint(JComponent.java:1038)<br />
at javax.swing.JComponent.paintChildren(JComponent.java:862)<br />
at javax.swing.JComponent.paint(JComponent.java:1038)<br />
at javax.swing.JComponent.paintChildren(JComponent.java:862)<br />
at javax.swing.JComponent.paint(JComponent.java:1038)<br />
at javax.swing.JLayeredPane.paint(JLayeredPane.java:567)<br />
at javax.swing.JComponent.paintChildren(JComponent.java:862)<br />
at javax.swing.JComponent.paint(JComponent.java:1038)<br />
at java.awt.GraphicsCallback$PaintCallback.run(GraphicsCallback.java:34)<br />
at sun.awt.SunGraphicsCallback.runOneComponent(SunGraphicsCallback.java:60)<br />
at sun.awt.SunGraphicsCallback.runComponents(SunGraphicsCallback.java:97)<br />
at java.awt.Container.paint(Container.java:1793)<br />
at java.awt.Window.paint(Window.java:3375)<br />
at javax.swing.RepaintManager.paintDirtyRegions(RepaintManager.java:822)<br />
at javax.swing.RepaintManager.paintDirtyRegions(RepaintManager.java:713)<br />
at javax.swing.RepaintManager.seqPaintDirtyRegions(RepaintManager.java:693)<br />
at javax.swing.SystemEventQueueUtilities$ComponentWorkRequest.run(SystemEventQueueUtilities.java:125)<br />
at java.awt.event.InvocationEvent.dispatch(InvocationEvent.java:209)<br />
at java.awt.EventQueue.dispatchEventImpl(EventQueue.java:678)<br />
at java.awt.EventQueue.access$000(EventQueue.java:86)<br />
at java.awt.EventQueue$1.run(EventQueue.java:639)<br />
at java.awt.EventQueue$1.run(EventQueue.java:637)<br />
at java.security.AccessController.doPrivileged(Native Method)<br />
at java.security.AccessControlContext$1.doIntersectionPrivilege(AccessControlContext.java:87)<br />
at java.awt.EventQueue.dispatchEvent(EventQueue.java:648)<br />
at java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:296)<br />
at java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:211)<br />
at java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread.java:201)<br />
at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:196)<br />
at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:188)<br />
at java.awt.EventDispatchThread.run(EventDispatchThread.java:122)<br />
</p>
</blockquote>

    </div>
  </div>
</div>
          

        <div>
          <h2 class="foldable">Change History</h2>
          <div id="changelog">
              <div class="change" id="trac-change-1">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:1" class="cnum">
      <a href="#comment:1">comment:1</a>
    </span>
                  </span>
                  Changed 2011-05-18T10:11:20-05:00 by bdezonia
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Owner</strong>
        changed from <em>curtis</em> to <em>bdezonia</em>
    </li><li>
      <strong>Status</strong>
        changed from <em>new</em> to <em>assigned</em>
    </li><li>
      <strong>Summary</strong>
        changed from <em>NullPtrExcep thrown when chaning type of image</em> to <em>NullPtrExcep thrown when changing type of image</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-2">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:2" class="cnum">
      <a href="#comment:2">comment:2</a>
    </span>
                  </span>
                  Changed 2011-05-19T11:40:26-05:00 by bdezonia
                </h3>
                
    <div class="comment searchable">
      
      <p>
Same thing happens if you rotate an image by 90 degrees (Image :: Transform :: Rotate 90 Right or Left). These plugins change the underlying arrangement of the displayed Dataset and it's associated ImgPlus. Type changes do not change shape of Dataset but do change data of associated ImgPlus.<br />
</p>

    </div>

              </div>
              <div class="change" id="trac-change-3">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:3" class="cnum">
      <a href="#comment:3">comment:3</a>
    </span>
                  </span>
                  Changed 2011-05-19T12:13:38-05:00 by bdezonia
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>assigned</em> to <em>accepted</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-4">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:4" class="cnum">
      <a href="#comment:4">comment:4</a>
    </span>
                  </span>
                  Changed 2011-05-19T12:56:58-05:00 by bdezonia
                </h3>
                
    <div class="comment searchable">
      
      <p>
Similar things happen when you zoom an image (and pan too?).<br />
</p>

    </div>

              </div>
              <div class="change" id="trac-change-5">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:5" class="cnum">
      <a href="#comment:5">comment:5</a>
    </span>
                  </span>
                  Changed 2011-05-19T17:28:13-05:00 by bdezonia
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>accepted</em> to <em>closed</em>
    </li><li>
      <strong>Resolution</strong>
        set to <em>fixed</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
Found that scale initialized to 0 in CanvasHelper. Now defaulting to 1 and have added support for setting an initialScale that you can revert to as needed. Made setZoom(0) revert to this scale. Fixed as of 2e75dbe96eb464569ab2fa462bfec7989c2708c3.<br />
</p>
<p>
Hatching a new ticket to support the loading and displaying of images that are not at 1:1 scale.<br />
</p>

    </div>

              </div>
          </div>
        </div>
    </div>
    </div>
  </body>
</html>
