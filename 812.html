<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  

  
  <!-- See: http://trac.edgewall.org/wiki/TracInterfaceCustomization -->


  <head>
    <title>
      #812 (Use ImageJA as Maven project to build ImageJ)
     – ImageJ
    </title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <link rel="search" href="/search" />
        <link rel="prev" href="/ticket/811" title="Ticket #811" />
        <link rel="last" href="/ticket/2043" title="Ticket #2043" />
        <link rel="help" href="/wiki/TracGuide" />
        <link rel="alternate" href="/ticket/812?format=csv" type="text/csv" class="csv" title="Comma-delimited Text" /><link rel="alternate" href="/ticket/812?format=tab" type="text/tab-separated-values" class="tab" title="Tab-delimited Text" /><link rel="alternate" href="/ticket/812?format=rss" type="application/rss+xml" class="rss" title="RSS Feed" />
        <link rel="next" href="/ticket/813" title="Ticket #813" />
        <link rel="start" href="/wiki" />
        <link rel="stylesheet" href="/chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="/chrome/common/css/ticket.css" type="text/css" /><link rel="stylesheet" href="/chrome/vote/css/tracvote.css" type="text/css" />
        <link rel="first" href="/ticket/1" title="Ticket #1" />
        <link rel="shortcut icon" href="/chrome/site/imagej-16.png" type="image/png" />
        <link rel="icon" href="/chrome/site/imagej-16.png" type="image/png" />
      <link type="application/opensearchdescription+xml" rel="search" href="/search/opensearch" title="Search ImageJ" />
    <script type="text/javascript">
      var auto_preview_timeout=2.0;
      var form_token="2ab4260787380f66d6e87bf5";
    </script>
    <script type="text/javascript" src="/chrome/common/js/jquery.js"></script><script type="text/javascript" src="/chrome/common/js/babel.js"></script><script type="text/javascript" src="/chrome/common/js/trac.js"></script><script type="text/javascript" src="/chrome/common/js/search.js"></script><script type="text/javascript" src="/chrome/common/js/folding.js"></script><script type="text/javascript" src="/chrome/common/js/wikitoolbar.js"></script><script type="text/javascript" src="/chrome/common/js/resizer.js"></script><script type="text/javascript" src="/chrome/common/js/auto_preview.js"></script>
    <!--[if lt IE 7]>
    <script type="text/javascript" src="/chrome/common/js/ie_pre7_hacks.js"></script>
    <![endif]-->
    <script type="text/javascript">
      jQuery(document).ready(function($) {
        $("div.description").find("h1,h2,h3,h4,h5,h6").addAnchor(_("Link to this section"));
        $(".foldable").enableFolding(false, true);
        var args = {realm: "ticket", id: 812, escape_newlines: 1}
        $("#comment").autoPreview("/wiki_render", args, function(textarea, text, rendered) {
            $("#ticketchange div.comment").html(rendered);
            if (rendered)
              $("#ticketchange").show();
            else if ($("#ticketchange ul.changes").length == 0)
              $("#ticketchange").hide();
        });
        $("#trac-comment-editor textarea").autoPreview("/wiki_render", args,
                                                       function(textarea, text, rendered) {
          var comment = $("#trac-comment-editor").next("div.comment");
          comment.html(rendered);
          if (rendered)
            comment.show();
          else
            comment.hide();
        });
        $("#modify").parent().toggleClass("collapsed");
        $(".trac-topnav a").click(function() { $("#modify").parent().removeClass("collapsed"); });
        /* only enable control elements for the currently selected action */
        var actions = $("#action input[name='action']");
        function updateActionFields() {
          actions.each(function () {
            $(this).siblings().find("*[id]").enable($(this).checked());
            $(this).siblings().filter("*[id]").enable($(this).checked());
          });
        }
        actions.click(updateActionFields);
        updateActionFields();
      });
    </script>
    <link rel="stylesheet" type="text/css" href="/chrome/site/style.css" />
  </head>
  <body>
    <div id="banner">
      <div id="header">
        <a id="logo" href="http://developer.imagej.net/"><img src="http://developer.imagej.net/files/imagej/logo.png" alt="ImageJ Trac" /></a>
      </div>
      <form id="search" action="/search" method="get">
        <div>
          <label for="proj-search">Search:</label>
          <input type="text" id="proj-search" name="q" size="18" value="" />
          <input type="submit" value="Search" />
        </div>
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="first"><a href="/login">Login</a></li><li><a href="/prefs">Preferences</a></li><li><a href="/wiki/TracGuide">Help/Guide</a></li><li><a href="/about">About Trac</a></li><li class="last"><a href="/reset_password">Forgot your password?</a></li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first"><a href="/wiki">Wiki</a></li><li><a href="/timeline">Timeline</a></li><li><a href="/roadmap">Roadmap</a></li><li class="active"><a href="/report">View Tickets</a></li><li class="last"><a href="/search">Search</a></li>
    </ul>
  </div>
    <div id="main">
      <div id="ctxtnav" class="nav">
        <h2>Context Navigation</h2>
          <ul>
              <li class="first"><span id="vote" title="Vote count"><img src="/chrome/vote/aupgray.png" alt="Up-vote" /><span id="votes">+0</span><img src="/chrome/vote/adowngray.png" alt="Down-vote" /></span></li><li><span>&larr; <a class="prev" href="/ticket/811" title="Ticket #811">Previous Ticket</a></span></li><li class="last"><span><a class="next" href="/ticket/813" title="Ticket #813">Next Ticket</a> &rarr;</span></li>
          </ul>
        <hr />
      </div>
    <div id="content" class="ticket">
      <h1 id="trac-ticket-title">
          <a href="/ticket/812">Ticket #812</a>
          <span class="status">(closed task: fixed)</span>
      </h1>
      <div id="ticket">
  <div class="date">
    <p>Opened <a class="timeline" href="/timeline?from=2011-10-10T12%3A54%3A40-05%3A00&amp;precision=second" title="2011-10-10T12:54:40-05:00 in Timeline">8 years</a> ago</p>
    <p>Last modified <a class="timeline" href="/timeline?from=2011-10-21T18%3A51%3A13-05%3A00&amp;precision=second" title="2011-10-21T18:51:13-05:00 in Timeline">8 years</a> ago</p>
  </div>
  <h2 class="summary searchable">Use ImageJA as Maven project to build ImageJ</h2>
  <table class="properties">
    <tr>
      <th id="h_reporter">Reported by:</th>
      <td headers="h_reporter" class="searchable">
        <a href="/query?status=!closed&amp;reporter=dscho">dscho</a>
      </td>
      <th id="h_owner">Owned by:</th>
      <td headers="h_owner">
        <a href="/query?status=!closed&amp;owner=dscho">dscho</a>
      </td>
    </tr>
    <tr>
        <th id="h_priority">
          Priority:
        </th>
        <td headers="h_priority">
              <a href="/query?status=!closed&amp;priority=major">major</a>
        </td>
        <th id="h_milestone">
          Milestone:
        </th>
        <td headers="h_milestone">
              <a class="closed milestone" href="/milestone/imagej2-b1-initial">imagej2-b1-initial</a>
        </td>
    </tr><tr>
        <th id="h_component">
          Component:
        </th>
        <td headers="h_component">
              <a href="/query?status=!closed&amp;component=Other">Other</a>
        </td>
        <th id="h_version">
          Version:
        </th>
        <td headers="h_version">
              <a href="/query?status=!closed&amp;version"></a>
        </td>
    </tr><tr>
        <th id="h_severity">
          Severity:
        </th>
        <td headers="h_severity">
              <a href="/query?status=!closed&amp;severity=serious">serious</a>
        </td>
        <th id="h_keywords">
          Keywords:
        </th>
        <td headers="h_keywords" class="searchable">
        </td>
    </tr><tr>
        <th id="h_cc">
          Cc:
        </th>
        <td headers="h_cc" class="searchable">
        </td>
        <th id="h_blockedby">
          Blocked By:
        </th>
        <td headers="h_blockedby">
        </td>
    </tr><tr>
        <th id="h_blocking">
          Blocking:
        </th>
        <td headers="h_blocking">
        </td>
        <th>
        </th>
        <td>
        </td>
    </tr>
  </table>
  <div class="description">
    <h3 id="comment:description">
      Description
      <span class="lastmod" title="2011-10-10 22:46:38+00:00">
        (last modified by dscho)
        (<a href="/ticket/812?action=diff&amp;version=2">diff</a>)
      </span>
    </h3>
    <div class="searchable">
      <p>
It is very convenient to use Eclipse's debugger when trying to find issues, but the ImageJ1 project is not yet integrated into ImageJ2's build procedure. Let's do that, by Mavenizing ImageJ and tracking the result in ImageJA.<br />
</p>
<p>
This task includes<br />
</p>
<ul><li>undoing all changes we have in ImageJA
</li><li>making ImageJA's 'master' branch follow ImageJ slavishly, but moving all the files into the appropriate places for Maven and adding/updating a pom.xml
</li><li>use Hudson to follow update the 'master' branch automatically
</li></ul><p>
The first step, undoing all changes in ImageJA means that Fiji needs to use Javassist to put back all the functionality it required ImageJA for. On the upside, it will allow Fiji to run with whatever IJ1 version is thrown at it.<br />
</p>

    </div>
  </div>
</div>
          

        <div>
          <h2 class="foldable">Change History</h2>
          <div id="changelog">
              <div class="change" id="trac-change-1">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:1" class="cnum">
      <a href="#comment:1">comment:1</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="/timeline?from=2011-10-10T12%3A57%3A07-05%3A00&amp;precision=second" title="2011-10-10T12:57:07-05:00 in Timeline">8 years</a> ago by dscho
                </h3>
                
    <div class="comment searchable">
      
      <p>
Oh, and it also means to redo the headless mode, which gives us the opportunity to avoid having to adjust the code manually everytime IJ1 adds new methods or fields to the GenericDialog or ij.Menus.<br />
</p>

    </div>

              </div>
              <div class="change" id="trac-change-2">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:2" class="cnum">
      <a href="#comment:2">comment:2</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="/timeline?from=2011-10-10T17%3A46%3A38-05%3A00&amp;precision=second" title="2011-10-10T17:46:38-05:00 in Timeline">8 years</a> ago by dscho
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Description</strong>
        modified (<a href="/ticket/812?action=diff&amp;version=2">diff</a>)
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-3">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:3" class="cnum">
      <a href="#comment:3">comment:3</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="/timeline?from=2011-10-12T22%3A59%3A50-05%3A00&amp;precision=second" title="2011-10-12T22:59:50-05:00 in Timeline">8 years</a> ago by dscho
                </h3>
                
    <div class="comment searchable">
      
      <p>
Progress so far:<br />
</p>
<ul><li>all the non-applet specific changes have been backed out of ImageJA.
</li><li>even the headless stuff was successfully rewritten using Javassist.
</li><li>writing out a headless.jar for scenarios where the security manager might disagree with runtime-patching was a breeze.
</li><li>we have a script in ImageJA's 'tools' branch which can update the 'pom' branch (and in the future will update the 'master' branch when we merged 'pom' into it).
</li></ul><p>
Tasks still to do:<br />
</p>
<ul><li>add a Hunkins/Jedson job,
</li><li>implement all the ImageJA-specific Applet stuff via Javassist.
</li><li>use that Javassist-based method in another Hudkins/Jenson job, triggered by the first, to write signed a .jar file and upload it where ImageJA is still expected to be uploaded.
</li></ul>
    </div>

              </div>
              <div class="change" id="trac-change-4">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:4" class="cnum">
      <a href="#comment:4">comment:4</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="/timeline?from=2011-10-14T23%3A46%3A56-05%3A00&amp;precision=second" title="2011-10-14T23:46:56-05:00 in Timeline">8 years</a> ago by dscho
                </h3>
                
    <div class="comment searchable">
      
      <p>
Problems. After building ImageJ using the new MiniMaven class (see ticket 813), things stopped working. The problem goes away when forcing ImageJ to compiled for Java 1.5, so it is a javassist problem.<br />
</p>

    </div>

              </div>
              <div class="change" id="trac-change-5">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:5" class="cnum">
      <a href="#comment:5">comment:5</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="/timeline?from=2011-10-16T21%3A27%3A57-05%3A00&amp;precision=second" title="2011-10-16T21:27:57-05:00 in Timeline">8 years</a> ago by dscho
                </h3>
                
    <div class="comment searchable">
      
      <p>
Okay, I squashed the Javassist bug. See <a class="ext-link" href="http://fiji.sc/cgi-bin/gitweb.cgi?p=javassist/.git;a=commitdiff;h=fb4d16aaad9a89896d1772a43f17988ed5808e82"><span class="icon"> </span>http://fiji.sc/cgi-bin/gitweb.cgi?p=javassist/.git;a=commitdiff;h=fb4d16aaad9a89896d1772a43f17988ed5808e82</a> for the fix, and <a class="ext-link" href="http://imagejdev.org/2011/10/17/art-debugging"><span class="icon"> </span>http://imagejdev.org/2011/10/17/art-debugging</a> for an unconventional writeup how I fixed it.<br />
</p>
<p>
So I committed the fix to our fork of Javassist (but I also sent the patch upstream, let's see whether I found the correct way to submit patches), committed a precompiled javassist to fiji.git and updated ImageJA's 'master' branch.<br />
</p>
<p>
Remaining tasks:<br />
</p>
<ul><li>install that Hunkjeds job to make HEAD requests to <a class="ext-link" href="http://imagej.nih.gov/ij/notes.html"><span class="icon"> </span>http://imagej.nih.gov/ij/notes.html</a> all the time, and if the timestamp changes, trigger
</li><li>another Hedjins job that updates the 'master' branch
</li><li>port the applet stuff into a Javassist-based Fiji plugin which can export a possibly signed ij.jar with the embedded applet stuff on the fly
</li><li>maybe make another Judhens job to build such an ij.jar automatically when a new ImageJ was released and upload stuff to Sourceforge
</li><li>get rid of the 'pom' branch when everything works
</li></ul>
    </div>

              </div>
              <div class="change" id="trac-change-6">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:6" class="cnum">
      <a href="#comment:6">comment:6</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="/timeline?from=2011-10-21T18%3A51%3A13-05%3A00&amp;precision=second" title="2011-10-21T18:51:13-05:00 in Timeline">8 years</a> ago by dscho
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>new</em> to <em>closed</em>
    </li><li>
      <strong>Resolution</strong>
        set to <em>fixed</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
The Jedhunks job is installed: <a class="ext-link" href="http://dev.imagejdev.org:8080/job/Synchronize-with-ImageJ1"><span class="icon"> </span>http://dev.imagejdev.org:8080/job/Synchronize-with-ImageJ1</a><br />
</p>
<p>
The applet stuff might very well be a case of YAGNI, let's take care of that iff we need it (and iff IJ2 does not offer a better solution to begin with).<br />
</p>

    </div>

              </div>
          </div>
        </div>
      <div id="help"><strong>Note:</strong> See
        <a href="/wiki/TracTickets">TracTickets</a> for help on using
        tickets.</div>
    </div>
    <div id="altlinks">
      <h3>Download in other formats:</h3>
      <ul>
        <li class="first">
          <a rel="nofollow" href="/ticket/812?format=csv" class="csv">Comma-delimited Text</a>
        </li><li>
          <a rel="nofollow" href="/ticket/812?format=tab" class="tab">Tab-delimited Text</a>
        </li><li class="last">
          <a rel="nofollow" href="/ticket/812?format=rss" class="rss">RSS Feed</a>
        </li>
      </ul>
    </div>
    </div>
    <div id="footer" lang="en" xml:lang="en"><hr />
      <a id="tracpowered" href="http://trac.edgewall.org/"><img src="/chrome/common/trac_logo_mini.png" height="30" width="107" alt="Trac Powered" /></a>
      <p class="left">Powered by <a href="/about"><strong>Trac 0.12.2</strong></a><br />
        By <a href="http://www.edgewall.org/">Edgewall Software</a>.</p>
      <p class="right">Visit the ImageJ project at<br /><a href="http://developer.imagej.net/">http://developer.imagej.net/</a></p>
    </div>
  </body>
</html>
