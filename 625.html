<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  

  
  <!-- See: http://trac.edgewall.org/wiki/TracInterfaceCustomization -->


  <head>
    <title>
      #625 (Hotkey problems in IJ2)
     – ImageJ
    </title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <link rel="search" href="/search" />
        <link rel="prev" href="/ticket/624" title="Ticket #624" />
        <link rel="last" href="/ticket/2043" title="Ticket #2043" />
        <link rel="help" href="/wiki/TracGuide" />
        <link rel="alternate" href="/ticket/625?format=csv" type="text/csv" class="csv" title="Comma-delimited Text" /><link rel="alternate" href="/ticket/625?format=tab" type="text/tab-separated-values" class="tab" title="Tab-delimited Text" /><link rel="alternate" href="/ticket/625?format=rss" type="application/rss+xml" class="rss" title="RSS Feed" />
        <link rel="next" href="/ticket/626" title="Ticket #626" />
        <link rel="start" href="/wiki" />
        <link rel="stylesheet" href="trac.css" type="text/css" /><link rel="stylesheet" href="ticket.css" type="text/css" /><link rel="stylesheet" href="tracvote.css" type="text/css" />
        <link rel="first" href="/ticket/1" title="Ticket #1" />
        <link rel="shortcut icon" href="/chrome/site/imagej-16.png" type="image/png" />
        <link rel="icon" href="/chrome/site/imagej-16.png" type="image/png" />
      <link type="application/opensearchdescription+xml" rel="search" href="/search/opensearch" title="Search ImageJ" />
    <script type="text/javascript">
      var auto_preview_timeout=2.0;
      var form_token="d874859a105dc4bc51fdd312";
    </script>
    <script type="text/javascript" src="/chrome/common/js/jquery.js"></script><script type="text/javascript" src="/chrome/common/js/babel.js"></script><script type="text/javascript" src="/chrome/common/js/trac.js"></script><script type="text/javascript" src="/chrome/common/js/search.js"></script><script type="text/javascript" src="/chrome/common/js/folding.js"></script><script type="text/javascript" src="/chrome/common/js/wikitoolbar.js"></script><script type="text/javascript" src="/chrome/common/js/resizer.js"></script><script type="text/javascript" src="/chrome/common/js/auto_preview.js"></script>
    <!--[if lt IE 7]>
    <script type="text/javascript" src="/chrome/common/js/ie_pre7_hacks.js"></script>
    <![endif]-->
    <script type="text/javascript">
      jQuery(document).ready(function($) {
        $("div.description").find("h1,h2,h3,h4,h5,h6").addAnchor(_("Link to this section"));
        $(".foldable").enableFolding(false, true);
        var args = {realm: "ticket", id: 625, escape_newlines: 1}
        $("#comment").autoPreview("/wiki_render", args, function(textarea, text, rendered) {
            $("#ticketchange div.comment").html(rendered);
            if (rendered)
              $("#ticketchange").show();
            else if ($("#ticketchange ul.changes").length == 0)
              $("#ticketchange").hide();
        });
        $("#trac-comment-editor textarea").autoPreview("/wiki_render", args,
                                                       function(textarea, text, rendered) {
          var comment = $("#trac-comment-editor").next("div.comment");
          comment.html(rendered);
          if (rendered)
            comment.show();
          else
            comment.hide();
        });
        $("#modify").parent().toggleClass("collapsed");
        $(".trac-topnav a").click(function() { $("#modify").parent().removeClass("collapsed"); });
        /* only enable control elements for the currently selected action */
        var actions = $("#action input[name='action']");
        function updateActionFields() {
          actions.each(function () {
            $(this).siblings().find("*[id]").enable($(this).checked());
            $(this).siblings().filter("*[id]").enable($(this).checked());
          });
        }
        actions.click(updateActionFields);
        updateActionFields();
      });
    </script>
    <link rel="stylesheet" type="text/css" href="style.css" />
  </head>
  <body>
    <div id="main">
    <div id="content" class="ticket">
      <h1 id="trac-ticket-title">
          <a href="/ticket/625">Ticket #625</a>
          <span class="status">(closed defect: moved)</span>
      </h1>
      <div id="ticket">
  <div class="date">
    <p>Opened <a class="timeline" href="/timeline?from=2011-06-20T17%3A20%3A46-05%3A00&amp;precision=second" title="2011-06-20T17:20:46-05:00 in Timeline">8 years</a> ago</p>
    <p>Last modified <a class="timeline" href="/timeline?from=2011-11-23T15%3A59%3A00-06%3A00&amp;precision=second" title="2011-11-23T15:59:00-06:00 in Timeline">8 years</a> ago</p>
  </div>
  <h2 class="summary searchable">Hotkey problems in IJ2</h2>
  <table class="properties">
    <tr>
      <th id="h_reporter">Reported by:</th>
      <td headers="h_reporter" class="searchable">
        <a href="/query?status=!closed&amp;reporter=bdezonia">bdezonia</a>
      </td>
      <th id="h_owner">Owned by:</th>
      <td headers="h_owner">
        <a href="/query?status=!closed&amp;owner=curtis">curtis</a>
      </td>
    </tr>
    <tr>
        <th id="h_priority">
          Priority:
        </th>
        <td headers="h_priority">
              <a href="/query?status=!closed&amp;priority=major">major</a>
        </td>
        <th id="h_milestone">
          Milestone:
        </th>
        <td headers="h_milestone">
              <a class="milestone" href="/milestone/imagej-2.5.0">imagej-2.5.0</a>
        </td>
    </tr><tr>
        <th id="h_component">
          Component:
        </th>
        <td headers="h_component">
              <a href="/query?status=!closed&amp;component=Plugin+Framework">Plugin Framework</a>
        </td>
        <th id="h_version">
          Version:
        </th>
        <td headers="h_version">
              <a href="/query?status=!closed&amp;version"></a>
        </td>
    </tr><tr>
        <th id="h_severity">
          Severity:
        </th>
        <td headers="h_severity">
              <a href="/query?status=!closed&amp;severity=serious">serious</a>
        </td>
        <th id="h_keywords">
          Keywords:
        </th>
        <td headers="h_keywords" class="searchable">
        </td>
    </tr><tr>
        <th id="h_cc">
          Cc:
        </th>
        <td headers="h_cc" class="searchable">
        </td>
        <th id="h_blockedby">
          Blocked By:
        </th>
        <td headers="h_blockedby">
        </td>
    </tr><tr>
        <th id="h_blocking">
          Blocking:
        </th>
        <td headers="h_blocking">
        </td>
        <th>
        </th>
        <td>
        </td>
    </tr>
  </table>
  <div class="description">
    <h3 id="comment:description">
      Description
    </h3>
    <div class="searchable">
      <p>
The hotkey accelerators are not completely working. As an example take the Next Axis Position and Previous Axis Position plugins. Ideally their hotkeys would be defined as GREATER and LESS and yet since they're shifted keys IJ2 can't handle it. I can fake it via setting hotkey to shift COMMA and shift PERIOD but they display poorly in the menus. This issue also affects the zoom plugins (shift EQUALS rather than PLUS).<br />
</p>

    </div>
  </div>
</div>
          

        <div>
          <h2 class="foldable">Change History</h2>
          <div id="changelog">
              <div class="change" id="trac-change-1">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:1" class="cnum">
      <a href="#comment:1">comment:1</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="/timeline?from=2011-06-23T11%3A07%3A34-05%3A00&amp;precision=second" title="2011-06-23T11:07:34-05:00 in Timeline">8 years</a> ago by bdezonia
                </h3>
                
    <div class="comment searchable">
      
      <p>
This is a Java issue that is still unfixed. See <a class="ext-link" href="http://stackoverflow.com/questions/5870685/java-swing-key-event-base"><span class="icon"> </span>http://stackoverflow.com/questions/5870685/java-swing-key-event-base</a> for a discussion of the issue. Their workaround is the same as ours.<br />
</p>
<p>
Wayne gets around this in IJ1 by defining ImageJ.java to be a KeyListener. It listens for the actual typing (event.getKeyChar()) of "&gt;" and launches plugin directly. This might be his workaround to the problem. We may need to do something similar.<br />
</p>

    </div>

              </div>
              <div class="change" id="trac-change-2">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:2" class="cnum">
      <a href="#comment:2">comment:2</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="/timeline?from=2011-08-01T08%3A22%3A48-05%3A00&amp;precision=second" title="2011-08-01T08:22:48-05:00 in Timeline">8 years</a> ago by gharris
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Owner</strong>
        changed from <em>bdezonia</em> to <em>gharris</em>
    </li><li>
      <strong>Status</strong>
        changed from <em>new</em> to <em>assigned</em>
    </li><li>
      <strong>Milestone</strong>
        changed from <em>imagej-2.0-beta2</em> to <em>imagej-2.0-alpha5</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-3">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:3" class="cnum">
      <a href="#comment:3">comment:3</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="/timeline?from=2011-08-15T09%3A23%3A31-05%3A00&amp;precision=second" title="2011-08-15T09:23:31-05:00 in Timeline">8 years</a> ago by gharris
                </h3>
                
    <div class="comment searchable">
      
      <p>
One approach... Add an EventSubscriber for KeyEvents and invoke the functionality there.<br />
</p>

    </div>

              </div>
              <div class="change" id="trac-change-4">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:4" class="cnum">
      <a href="#comment:4">comment:4</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="/timeline?from=2011-09-02T10%3A10%3A32-05%3A00&amp;precision=second" title="2011-09-02T10:10:32-05:00 in Timeline">8 years</a> ago by gharris
                </h3>
                
    <div class="comment searchable">
      
      <p>
This a now addressed with AWTKeyEventDispatcherGlobal, although there are still some focus-related issues.  Specifically, the accelerator keys defined in the menus are not responsive if the focus is not on the ApplicationFrame (at least in Windows).<br />
</p>

    </div>

              </div>
              <div class="change" id="trac-change-5">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:5" class="cnum">
      <a href="#comment:5">comment:5</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="/timeline?from=2011-09-02T10%3A22%3A43-05%3A00&amp;precision=second" title="2011-09-02T10:22:43-05:00 in Timeline">8 years</a> ago by bdezonia
                </h3>
                
    <div class="comment searchable">
      
      <p>
On the Mac the accelerator keys are responsive whether you've selected the app bar or the image window. Testing with "&gt;" and "&lt;" on multidim images works correctly even when multiple images are open (moving only the sliders of the last active window).<br />
</p>
<p>
Note this ticket has the unaddressed problem (at least on the Mac) that the accelerators for "&gt;" and "&lt;" show in the menus as "shift ." and "shift ,". Grant, not sure if you meant to address that part too.<br />
</p>

    </div>

              </div>
              <div class="change" id="trac-change-6">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:6" class="cnum">
      <a href="#comment:6">comment:6</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="/timeline?from=2011-11-06T22%3A33%3A56-06%3A00&amp;precision=second" title="2011-11-06T22:33:56-06:00 in Timeline">8 years</a> ago by curtis
                </h3>
                
    <div class="comment searchable">
      
      <p>
I believe this problem can be fixed by making the AcceleratorHandler smarter about detecting this sort of situation. If you type e.g. shift+PERIOD to get a GREATER, the event that fires has a code of PERIOD (not GREATER) with the shift modifier set. (Run the "Watch Events" plugin and give it a try.) However, the character <em>is</em> a '&gt;' which means that we can potentially invoke special handling for the situation.<br />
</p>
<p>
Once the AcceleratorHandler is smart enough to realize that shift+PERIOD should fire a command with an accelerator of GREATER on U.S. keyboards (based on analysis of the character), it won't matter that the Swing menu infrastructure ignores the key event—the AcceleratorHandler will fire the command anyway.<br />
</p>
<p>
However, to make this work, we may need to provide a way to inquire what the given KeyCode is for a char, and vice versa.<br />
</p>
<p>
Further investigation needed.<br />
</p>

    </div>

              </div>
              <div class="change" id="trac-change-7">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:7" class="cnum">
      <a href="#comment:7">comment:7</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="/timeline?from=2011-11-23T15%3A30%3A19-06%3A00&amp;precision=second" title="2011-11-23T15:30:19-06:00 in Timeline">8 years</a> ago by curtis
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>assigned</em> to <em>closed</em>
    </li><li>
      <strong>Resolution</strong>
        set to <em>fixed</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
(In <a class="missing changeset" title="No default repository defined">[4482]</a>) Change displayed shortcuts for axis pos plugins<br />
</p>
<p>
Closes <a class="closed ticket" href="/ticket/625" title="defect: Hotkey problems in IJ2 (closed: moved)">#625</a>. It does not fully solve the issue of modifiers affecting a<br />
key code (they still don't), nor does it make AcceleratorHandler smarter<br />
in general, but in the case of the axis position plugins displaying &lt;<br />
and &gt; accelerators in the menu, those keys *do* work now because<br />
the AxisPositionHandler picks them up.<br />
</p>

    </div>

              </div>
              <div class="change" id="trac-change-8">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:8" class="cnum">
      <a href="#comment:8">comment:8</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="/timeline?from=2011-11-23T15%3A53%3A06-06%3A00&amp;precision=second" title="2011-11-23T15:53:06-06:00 in Timeline">8 years</a> ago by curtis
                </h3>
                
    <div class="comment searchable">
      
      <p>
(In <a class="missing changeset" title="No default repository defined">[4493]</a>) Add always-active ZoomHandler to handle +/- keys<br />
</p>
<p>
This is instead of letting the ZoomIn and ZoomOut accelerators function,<br />
since ZoomIn was mapped to ctrl/meta + equals, which was kind of hacky.<br />
See <a class="closed ticket" href="/ticket/625" title="defect: Hotkey problems in IJ2 (closed: moved)">#625</a> for details.<br />
</p>

    </div>

              </div>
              <div class="change" id="trac-change-9">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:9" class="cnum">
      <a href="#comment:9">comment:9</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="/timeline?from=2011-11-23T15%3A58%3A15-06%3A00&amp;precision=second" title="2011-11-23T15:58:15-06:00 in Timeline">8 years</a> ago by curtis
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>closed</em> to <em>reopened</em>
    </li><li>
      <strong>Resolution</strong>
        <em>fixed</em> deleted
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
On second thought, I am reopening this ticket but pushing it to a later milestone, now that we have resolved the problem for the axis position and zoom plugin cases. It would still be good to implement a more general solution that is smart about mapping modified keys to their respective key codes.<br />
</p>

    </div>

              </div>
              <div class="change" id="trac-change-10">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:10" class="cnum">
      <a href="#comment:10">comment:10</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="/timeline?from=2011-11-23T15%3A59%3A00-06%3A00&amp;precision=second" title="2011-11-23T15:59:00-06:00 in Timeline">8 years</a> ago by curtis
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Milestone</strong>
        changed from <em>imagej-2.0-beta1</em> to <em>imagej-2.5</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-11">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:11" class="cnum">
      <a href="#comment:11">comment:11</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="/timeline?from=2012-01-26T12%3A44%3A47-06%3A00&amp;precision=second" title="2012-01-26T12:44:47-06:00 in Timeline">7 years</a> ago by curtis
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Owner</strong>
        changed from <em>gharris</em> to <em>curtis</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-10">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:10" class="cnum">
      <a href="#comment:10">comment:10</a>
    </span>
                  </span>
                  Changed <a class="timeline" href="/timeline?from=2014-05-01T07%3A00%3A36-05%3A00&amp;precision=second" title="2014-05-01T07:00:36-05:00 in Timeline">5 years</a> ago by curtis
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>reopened</em> to <em>closed</em>
    </li><li>
      <strong>Resolution</strong>
        set to <em>moved</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
Migrated to <a class="ext-link" href="https://github.com/scijava/scijava-common/issues/53"><span class="icon"> </span>https://github.com/scijava/scijava-common/issues/53</a><br />
</p>

    </div>

              </div>
          </div>
        </div>
      <div id="help"><strong>Note:</strong> See
        <a href="/wiki/TracTickets">TracTickets</a> for help on using
        tickets.</div>
    </div>
    <div id="altlinks">
      <h3>Download in other formats:</h3>
      <ul>
        <li class="first">
          <a rel="nofollow" href="/ticket/625?format=csv" class="csv">Comma-delimited Text</a>
        </li><li>
          <a rel="nofollow" href="/ticket/625?format=tab" class="tab">Tab-delimited Text</a>
        </li><li class="last">
          <a rel="nofollow" href="/ticket/625?format=rss" class="rss">RSS Feed</a>
        </li>
      </ul>
    </div>
    </div>
    <div id="footer" lang="en" xml:lang="en"><hr />
      <a id="tracpowered" href="http://trac.edgewall.org/"><img src="/chrome/common/trac_logo_mini.png" height="30" width="107" alt="Trac Powered" /></a>
      <p class="left">Powered by <a href="/about"><strong>Trac 0.12.2</strong></a><br />
        By <a href="http://www.edgewall.org/">Edgewall Software</a>.</p>
      <p class="right">Visit the ImageJ project at<br /><a href="http://developer.imagej.net/">http://developer.imagej.net/</a></p>
    </div>
  </body>
</html>
