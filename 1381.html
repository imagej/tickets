<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  

  
  <!-- See: http://trac.edgewall.org/wiki/TracInterfaceCustomization -->


  <head>
    <title>
      #1381 (Support ColorTable16 images)
     – ImageJ
    </title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <link rel="stylesheet" href="trac.css" type="text/css" /><link rel="stylesheet" href="ticket.css" type="text/css" /><link rel="stylesheet" href="tracvote.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="style.css" />
  </head>
  <body>
    <div id="main">
    <div id="content" class="ticket">
      <h1 id="trac-ticket-title">
          <a href="1381.html">Ticket #1381</a>
          <span class="status">(closed task: fixed)</span>
      </h1>
      <div id="ticket">
  <div class="date">
    <p>Opened 2012-08-10T18:28:07-05:00</p>
    <p>Last modified 2012-09-08T08:43:12-05:00</p>
  </div>
  <h2 class="summary searchable">Support ColorTable16 images</h2>
  <table class="properties">
    <tr>
      <th id="h_reporter">Reported by:</th>
      <td headers="h_reporter" class="searchable">
        aivar
      </td>
      <th id="h_owner">Owned by:</th>
      <td headers="h_owner">
        aivar
      </td>
    </tr>
    <tr>
        <th id="h_priority">
          Priority:
        </th>
        <td headers="h_priority">
              minor
        </td>
        <th id="h_milestone">
          Milestone:
        </th>
        <td headers="h_milestone">
              <strike>imagej2-b4-plugins</strike>
        </td>
    </tr><tr>
        <th id="h_component">
          Component:
        </th>
        <td headers="h_component">
              Display API
        </td>
        <th id="h_version">
          Version:
        </th>
        <td headers="h_version">
              
        </td>
    </tr><tr>
        <th id="h_severity">
          Severity:
        </th>
        <td headers="h_severity">
              minor
        </td>
        <th id="h_keywords">
          Keywords:
        </th>
        <td headers="h_keywords" class="searchable">
        </td>
    </tr><tr>
        <th id="h_cc">
          Cc:
        </th>
        <td headers="h_cc" class="searchable">
        </td>
        <th id="h_blockedby">
          Blocked By:
        </th>
        <td headers="h_blockedby">
              <a class="closed" href="1382.html" title="Refactor ColorTables">#1382</a>
        </td>
    </tr><tr>
        <th id="h_blocking">
          Blocking:
        </th>
        <td headers="h_blocking">
              <a class="closed" href="1333.html" title="Add new functionality to showcase IJ2 [plugins]">#1333</a>
        </td>
        <th>
        </th>
        <td>
        </td>
    </tr>
  </table>
  <div class="description">
    <h3 id="comment:description">
      Description
    </h3>
    <div class="searchable">
      <p>
Certain image formats that BioFormats supports allow for 16-bit color tables.<br />
</p>
<p>
ColorTable16 exists in IJ2 but can't actually be used to display.<br />
</p>

    </div>
  </div>
</div>
          
    <div id="attachments">
        <h2 class="foldable">Attachments</h2>
        <div>
          <dl class="attachments">
              <dt>
    <a href="attach/1381/20x%20deconvol%20demo%20lif%20in%20LAS%20AF%20viewer.png">20x deconvol demo lif in LAS AF viewer.png</a>
       (<span title="160399 bytes">156.6 KB</span>) -
      added by <em>aivar</em> 2012-09-05T17:09:20-05:00.
  </dt>
              <dd>
                This is our sample lif file "20x devol demo" viewed with Leica's LAS AF Lite viewer.
              </dd>
              <dt>
    <a href="attach/1381/20x%20deconvol%20demo%20lif%20in%20IJ2.png">20x deconvol demo lif in IJ2.png</a>
       (<span title="106893 bytes">104.4 KB</span>) -
      added by <em>aivar</em> 2012-09-05T17:14:52-05:00.
  </dt>
              <dd>
                Here is "20x deconvol demo.lif" as displayed in IJ2.
              </dd>
          </dl>
          
        </div>
    </div>

        <div>
          <h2 class="foldable">Change History</h2>
          <div id="changelog">
              <div class="change" id="trac-change-1">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:1" class="cnum">
      <a href="#comment:1">comment:1</a>
    </span>
                  </span>
                  Changed 2012-08-10T18:30:40-05:00 by aivar
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Blocked By</strong>
        <em>1382</em> added
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-2">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:2" class="cnum">
      <a href="#comment:2">comment:2</a>
    </span>
                  </span>
                  Changed 2012-08-10T18:46:50-05:00 by aivar
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Component</strong>
        changed from <em>other</em> to <em>ij-display</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-3">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:3" class="cnum">
      <a href="#comment:3">comment:3</a>
    </span>
                  </span>
                  Changed 2012-08-14T10:44:19-05:00 by bdezonia
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Blocking</strong>
        <em>1333</em> added
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-4">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:4" class="cnum">
      <a href="#comment:4">comment:4</a>
    </span>
                  </span>
                  Changed 2012-08-31T18:22:01-05:00 by aivar
                </h3>
                
    <div class="comment searchable">
      
      <p>
Searching for 16-bit palettes I found:<br />
</p>
<p>
"TIFF also supports palette images, but baseline TIFF allows only 4- and 8-bit pixel depths. Perhaps a more useful comparison is with the superset of baseline TIFF that is supported by Sam Leffler's free libtiff, which has become the software industry's unofficial standard for TIFF decoding. libtiff supports palette bit depths of 1, 2, 4, 8, and 16 bits." <a class="ext-link" href="http://www.libpng.org/pub/png/book/chapter08.html"><span class="icon"> </span>http://www.libpng.org/pub/png/book/chapter08.html</a><br />
</p>
<p>
I found a sample image on the LOCI server at data/tiff/samples/imagemagick/flower-palette-strip-16.tif.  This is just an indexed color RGB image that uses about 3000 colors out of the possible 64K palette.<br />
</p>
<p>
Unfortunately IJ1 maps the entire palette (3000 colors and the rest black) to the min/max of the image's histogram.  So only ~3/64 of the pixels are colorized, the rest are black.<br />
</p>

    </div>

              </div>
              <div class="change" id="trac-change-5">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:5" class="cnum">
      <a href="#comment:5">comment:5</a>
    </span>
                  </span>
                  Changed 2012-09-05T17:04:14-05:00 by aivar
                </h3>
                
    <div class="comment searchable">
      
      <p>
Mapping the entire palette to the min/max of the images histogram occurs when the 'isFalseColor' flag is true, that is the indices are the actual data, not the palette values.<br />
</p>

    </div>

              </div>
              <div class="change">
                <h3 class="change">
                  Changed 2012-09-05T17:09:20-05:00 by aivar
                </h3>
                
  <ul class="changes">
    <li>
      <strong>attachment</strong>
        <a href="attach/1381/20x%20deconvol%20demo%20lif%20in%20LAS%20AF%20viewer.png"><em>20x deconvol demo lif in LAS AF viewer.png</em></a>
          added
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
This is our sample lif file "20x devol demo" viewed with Leica's LAS AF Lite viewer.<br />
</p>

    </div>

              </div>
              <div class="change">
                <h3 class="change">
                  Changed 2012-09-05T17:14:52-05:00 by aivar
                </h3>
                
  <ul class="changes">
    <li>
      <strong>attachment</strong>
        <a href="attach/1381/20x%20deconvol%20demo%20lif%20in%20IJ2.png"><em>20x deconvol demo lif in IJ2.png</em></a>
          added
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
Here is "20x deconvol demo.lif" as displayed in IJ2.<br />
</p>

    </div>

              </div>
              <div class="change" id="trac-change-6">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:6" class="cnum">
      <a href="#comment:6">comment:6</a>
    </span>
                  </span>
                  Changed 2012-09-06T15:20:13-05:00 by aivar
                </h3>
                
    <div class="comment searchable">
      
      <p>
The LIF file associated with the attachments has a 16-bit ramped palette.  Combinations of RGB channels yield colors.<br />
</p>
<p>
The OIF files I've examined have a palette of 256 X 0, 256 X 0x101, 256 X 0x202,... 256 X 0xffff.  Increments of 0x101 create an even ramp that goes from 0x0000...0xffff.  (Truncating lower bits gives you an even 8-bit ramp.)  So they don't make use of 64K entries (might as well use 256 entries) but do use the full 16-bit pixel depth.<br />
</p>

    </div>

                <div class="trac-lastedit ">
                  Last edited 2012-09-06T15:21:03-05:00
                      by aivar
                </div>
              </div>
              <div class="change" id="trac-change-7">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:7" class="cnum">
      <a href="#comment:7">comment:7</a>
    </span>
                  </span>
                  Changed 2012-09-07T11:26:16-05:00 by bdezonia
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Blocking</strong>
        <em>1460</em> added; <em>1333</em> removed
    </li><li>
      <strong>Milestone</strong>
        changed from <em>imagej-2.0.0-beta4</em> to <em>imagej-2.0.0-beta5</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-8">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:8" class="cnum">
      <a href="#comment:8">comment:8</a>
    </span>
                  </span>
                  Changed 2012-09-07T16:49:51-05:00 by aivar
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Status</strong>
        changed from <em>new</em> to <em>closed</em>
    </li><li>
      <strong>Resolution</strong>
        set to <em>fixed</em>
    </li><li>
      <strong>Milestone</strong>
        changed from <em>imagej-2.0.0-beta5</em> to <em>imagej-2.0.0-beta4</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      <p>
This is working now, in time for imagej-2.0.0-beta4 milestone.<br />
</p>

    </div>

              </div>
              <div class="change" id="trac-change-9">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:9" class="cnum">
      <a href="#comment:9">comment:9</a>
    </span>
                  </span>
                  Changed 2012-09-08T08:43:12-05:00 by bdezonia
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Blocking</strong>
        <em>1333</em> added; <em>1460</em> removed
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
          </div>
        </div>
    </div>
    </div>
  </body>
</html>
