<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  

  
  <!-- See: http://trac.edgewall.org/wiki/TracInterfaceCustomization -->


  <head>
    <title>
      #1566 (Zoom out is slow)
     â€“ ImageJ
    </title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <link rel="stylesheet" href="trac.css" type="text/css" /><link rel="stylesheet" href="ticket.css" type="text/css" /><link rel="stylesheet" href="tracvote.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="style.css" />
  </head>
  <body>
    <div id="main">
    <div id="content" class="ticket">
      <h1 id="trac-ticket-title">
          <a href="/ticket/1566">Ticket #1566</a>
          <span class="status">(assigned defect)</span>
      </h1>
      <div id="ticket">
  <div class="date">
    <p>Opened 2012-11-07T15:24:28-06:00</p>
    <p>Last modified 2013-01-22T12:45:23-06:00</p>
  </div>
  <h2 class="summary searchable">Zoom out is slow</h2>
  <table class="properties">
    <tr>
      <th id="h_reporter">Reported by:</th>
      <td headers="h_reporter" class="searchable">
        bdezonia
      </td>
      <th id="h_owner">Owned by:</th>
      <td headers="h_owner">
        dscho
      </td>
    </tr>
    <tr>
        <th id="h_priority">
          Priority:
        </th>
        <td headers="h_priority">
              major
        </td>
        <th id="h_milestone">
          Milestone:
        </th>
        <td headers="h_milestone">
              <a class="milestone" href="/milestone/imagej2-unscheduled">imagej2-unscheduled</a>
        </td>
    </tr><tr>
        <th id="h_component">
          Component:
        </th>
        <td headers="h_component">
              Core
        </td>
        <th id="h_version">
          Version:
        </th>
        <td headers="h_version">
              
        </td>
    </tr><tr>
        <th id="h_severity">
          Severity:
        </th>
        <td headers="h_severity">
              serious
        </td>
        <th id="h_keywords">
          Keywords:
        </th>
        <td headers="h_keywords" class="searchable">
        </td>
    </tr><tr>
        <th id="h_cc">
          Cc:
        </th>
        <td headers="h_cc" class="searchable">
        </td>
        <th id="h_blockedby">
          Blocked By:
        </th>
        <td headers="h_blockedby">
        </td>
    </tr><tr>
        <th id="h_blocking">
          Blocking:
        </th>
        <td headers="h_blocking">
              <a class="new" href="/ticket/1326" title="Improve zooming behavior">#1326</a>
        </td>
        <th>
        </th>
        <td>
        </td>
    </tr>
  </table>
  <div class="description">
    <h3 id="comment:description">
      Description
    </h3>
    <div class="searchable">
      <p>
Open embryos and zoom in a handful of steps. Now zoom out repeatedly by pressing minus key. It gets very slow and one does not reach a minimal zoom for a long time (with some zoom steps skipped).<br />
</p>

    </div>
  </div>
</div>
          

        <div>
          <h2 class="foldable">Change History</h2>
          <div id="changelog">
              <div class="change" id="trac-change-1">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:1" class="cnum">
      <a href="#comment:1">comment:1</a>
    </span>
                  </span>
                  Changed 2012-11-07T15:27:16-06:00 by bdezonia
                </h3>
                
    <div class="comment searchable">
      
      <p>
Happens in beta 5 also. Note that it seems event processing might be tied up (an event storm in place?). A zoom is getting recorded (since steps can get skipped) but not updated on the screen quickly enough.<br />
</p>

    </div>

              </div>
              <div class="change" id="trac-change-2">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:2" class="cnum">
      <a href="#comment:2">comment:2</a>
    </span>
                  </span>
                  Changed 2012-11-07T15:27:46-06:00 by bdezonia
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Blocking</strong>
        <em>1563</em> added
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-3">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:3" class="cnum">
      <a href="#comment:3">comment:3</a>
    </span>
                  </span>
                  Changed 2012-11-07T15:59:59-06:00 by bdezonia
                </h3>
                
    <div class="comment searchable">
      
      <p>
Note it does not happen with boats. Embryos is big and merged color. Test with different data to narrow. I did. It doesn't happen with clown. It happens some with particles. So its size that is the issue.<br />
</p>
<p>
Also note that on zoom out threads are getting hatched that are stuck timed waiting. They are named "ImageJ-2578ab1f-Thread-1" etc. Determine if that "ImageJ" prepend refers to IJ1 or IJ12.<br />
</p>
<p>
We also should consider the possibility that this happens due to a change in IJ1 rather than in IJ2. Run with a different IJ1 version.<br />
</p>

    </div>

                <div class="trac-lastedit ">
                  Last edited 2012-11-07T16:19:42-06:00
                      by bdezonia
                </div>
              </div>
              <div class="change" id="trac-change-4">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:4" class="cnum">
      <a href="#comment:4">comment:4</a>
    </span>
                  </span>
                  Changed 2012-11-21T13:28:07-06:00 by bdezonia
                </h3>
                
    <div class="comment searchable">
      
      <p>
It's IJ2 threads. And it can happen with Boats (just not as easily as embryos). Using print statements I see that zoom ins always quickly pass through the DefaultImageCanvas::setZoom() calls. When repeatedly zooming out the setZoom() has not yet terminated when a new setZoom() call is made.<br />
</p>
<p>
Note that zoom in should be quick because it requires a scaling of the current image of the canvas. A zoom out may require a new image to be created if the current view is clipped. This would explain why zoom out is slower.<br />
</p>
<p>
Can inspect commands that are hatched in the "ImageJ..." threads and they are ZoomOut commands. Not sure why the ZoomOut commands are stuck in TIMED_WAITING. No thread wait(0 or sleep() calls have been initiated by IJ2.<br />
</p>

    </div>

              </div>
              <div class="change" id="trac-change-5">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:5" class="cnum">
      <a href="#comment:5">comment:5</a>
    </span>
                  </span>
                  Changed 2012-11-27T12:53:04-06:00 by bdezonia
                </h3>
                
    <div class="comment searchable">
      
      <p>
Made some changes last week. Now zoom events will be able to be recorded in macros. So now zoom in and zoom out both can show the error. Many threads can get hatched if you press a zooming hotkey repeatedly. Zooms are slow. Threads all seem to be ZoomIn and ZoomOut commands. Can't determine why the threads don't terminate or what they are waiting on. After a long wait they will terminate.<br />
</p>

    </div>

              </div>
              <div class="change" id="trac-change-6">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:6" class="cnum">
      <a href="#comment:6">comment:6</a>
    </span>
                  </span>
                  Changed 2012-11-27T13:09:22-06:00 by dscho
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Owner</strong>
        changed from <em>bdezonia</em> to <em>dscho</em>
    </li><li>
      <strong>Status</strong>
        changed from <em>new</em> to <em>assigned</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-7">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:7" class="cnum">
      <a href="#comment:7">comment:7</a>
    </span>
                  </span>
                  Changed 2012-11-27T13:09:30-06:00 by dscho
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Milestone</strong>
        changed from <em>imagej-2.0.0-beta7</em> to <em>imagej-2.0.0-beta6</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-8">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:8" class="cnum">
      <a href="#comment:8">comment:8</a>
    </span>
                  </span>
                  Changed 2012-11-27T13:11:35-06:00 by bdezonia
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Blocking</strong>
        <em>1574</em> added; <em>1563</em> removed
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-9">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:9" class="cnum">
      <a href="#comment:9">comment:9</a>
    </span>
                  </span>
                  Changed 2012-11-29T14:53:58-06:00 by bdezonia
                </h3>
                
    <div class="comment searchable">
      
      <p>
Some scribblings I had in a notebook before I relinquished this ticket to dcsho:<br />
</p>
<blockquote>
<p>
Threads related to ZoomIn or ZoomOut commands hang around in a TIMED_WAITING state.<br />
Not hanging in syncUI() or syncCanvas(). But note those methods do some event hatching.<br />
Not a reentry prob with sync(). Making it synchronized made no difference.<br />
Removing the accelerators from ZoomIn and ZoomOut no longer fixes any issue.<br />
Is it a weird order of execution in the thread service? investigate.<br />
</p>
</blockquote>

    </div>

              </div>
              <div class="change" id="trac-change-10">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:10" class="cnum">
      <a href="#comment:10">comment:10</a>
    </span>
                  </span>
                  Changed 2012-12-27T11:00:14-06:00 by curtis
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Blocking</strong>
        <em>1326</em> added; <em>1574</em> removed
    </li><li>
      <strong>Milestone</strong>
        changed from <em>imagej2-b6-legacy-undo</em> to <em>imagej2-b7-ndim-data</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
              <div class="change" id="trac-change-11">
                <h3 class="change">
                  <span class="threading">
                    <span id="comment:11" class="cnum">
      <a href="#comment:11">comment:11</a>
    </span>
                  </span>
                  Changed 2013-01-22T12:45:23-06:00 by bdezonia
                </h3>
                
  <ul class="changes">
    <li>
      <strong>Milestone</strong>
        changed from <em>imagej2-b7-ndim-data</em> to <em>imageJ-2.0.0-TO-REFILE</em>
    </li>
  </ul>
    <div class="comment searchable">
      
      
    </div>

              </div>
          </div>
        </div>
      <div id="help"><strong>Note:</strong> See
        <a href="/wiki/TracTickets">TracTickets</a> for help on using
        tickets.</div>
    </div>
    <div id="altlinks">
      <h3>Download in other formats:</h3>
      <ul>
        <li class="first">
          <a rel="nofollow" href="/ticket/1566?format=csv" class="csv">Comma-delimited Text</a>
        </li><li>
          <a rel="nofollow" href="/ticket/1566?format=tab" class="tab">Tab-delimited Text</a>
        </li><li class="last">
          <a rel="nofollow" href="/ticket/1566?format=rss" class="rss">RSS Feed</a>
        </li>
      </ul>
    </div>
    </div>
    <div id="footer" lang="en" xml:lang="en"><hr />
      <a id="tracpowered" href="http://trac.edgewall.org/"><img src="/chrome/common/trac_logo_mini.png" height="30" width="107" alt="Trac Powered" /></a>
      <p class="left">Powered by <a href="/about"><strong>Trac 0.12.2</strong></a><br />
        By <a href="http://www.edgewall.org/">Edgewall Software</a>.</p>
      <p class="right">Visit the ImageJ project at<br /><a href="http://developer.imagej.net/">http://developer.imagej.net/</a></p>
    </div>
  </body>
</html>
